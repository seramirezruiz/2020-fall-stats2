<!DOCTYPE html>
<html lang="en">
    
    


    <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.80.0" />

    
    
    

<title>Session 01 - Foundations • 2020-II Statistical Modeling and Causal Inference Tutorial</title>


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Session 01 - Foundations"/>
<meta name="twitter:description" content="Welcome! The practical component of the Statistics II: Statistical Modeling and Causal Inference course relies largely in R programming. Today we will center on some of the necessary skills to perform the assignments for the course. Finally, we will dive into some of the substance of the class by exploring the Potential Outcomes Framework.
In this tutorial, you will learn to:
 identify the some of the basic functionalities of R and RStudio import data sets into your R environment distinguish the foundations of the Potential Outcomes Framework (POF) apply dplyr verbs to retrieve estimates   R and RStudio: Basics The RStudio layout RStudio is an integrated development environment (IDE) for R."/>

<meta property="og:title" content="Session 01 - Foundations" />
<meta property="og:description" content="Welcome! The practical component of the Statistics II: Statistical Modeling and Causal Inference course relies largely in R programming. Today we will center on some of the necessary skills to perform the assignments for the course. Finally, we will dive into some of the substance of the class by exploring the Potential Outcomes Framework.
In this tutorial, you will learn to:
 identify the some of the basic functionalities of R and RStudio import data sets into your R environment distinguish the foundations of the Potential Outcomes Framework (POF) apply dplyr verbs to retrieve estimates   R and RStudio: Basics The RStudio layout RStudio is an integrated development environment (IDE) for R." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://seramirezruiz.github.io/2020-fall-stats2/scripts/foundations/" />
<meta property="article:published_time" content="2020-09-01T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-09-01T00:00:00+00:00" /><meta property="og:site_name" content="Statistical Modeling and Causal Inference Tutorial | 2020-II" />


    


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">








<link rel="stylesheet" href="/2020-fall-stats2/scss/hyde-hyde.71157e768c4e111a23c3531b95e0cbb59bbef3c9e6901d36247cb53d6b6be258.css" integrity="sha256-cRV&#43;doxOERojw1MbleDLtZu&#43;88nmkB02JHy1PWtr4lg=">


<link rel="stylesheet" href="/2020-fall-stats2/scss/print.2744dcbf8a0b2e74f8a50e4b34e5f441be7cf93cc7de27029121c6a09f9e77bc.css" integrity="sha256-J0Tcv4oLLnT4pQ5LNOX0Qb58&#43;TzH3icCkSHGoJ&#43;ed7w=" media="print">



    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.png">
    
    

</head>


    <body class=" ">
    

    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
    
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>


<div class="sidebar">
  <div class="container ">
    <div class="sidebar-about">
      <span class="site__title">
        <a href="https://seramirezruiz.github.io/2020-fall-stats2">
        
          2020-II Statistical Modeling and Causal Inference Tutorial
        
        </a>
      </span>
      
      
      <p class="site__description">
        
      </p>
    </div>
    <div class="collapsible-menu">
      <input type="checkbox" id="menuToggle">
      <label for="menuToggle">2020-II Statistical Modeling and Causal Inference Tutorial</label>
      <div class="menu-content">
        <div>
	<ul class="sidebar-nav">
		 
		 
			 
				<li>
					<a href="/2020-fall-stats2/about/"><i class='fa fa-info'></i>
						<span>About</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/2020-fall-stats2/scripts/"><i class='fa fa-code'></i>
						<span>Scripts</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/2020-fall-stats2/slides/"><i class='fa fa-laptop'></i>
						<span>Slides</span>
					</a>
				</li>
			 
		
	</ul>
</div>

        <section class="social">
	
	<a href="https://twitter.com/seramirezruiz" rel="me"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	<a href="https://github.com/seramirezruiz" rel="me"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	<a href="mailto:ramirez-ruiz@hertie-school.org" rel="me"><i class="fas fa-at fa-lg" aria-hidden="true"></i></a>
	
	
	
	
</section>

      </div>
    </div>
    
<div class="copyright">
  &copy; 2020 - 2021 Sebastian Ramirez Ruiz
  
    <a href="https://creativecommons.org/licenses/by-sa/4.0">CC BY-SA 4.0</a>
  
</div>



  </div>
</div>

        <div class="content container">
            
    
<article>
  <header>
    <h1>Session 01 - Foundations</h1>
    
    
<div class="post__meta">
    
    
      <i class="fas fa-calendar-alt"></i> Sep 1, 2020
    
    
    
    
    
    <br/>
    <i class="fas fa-clock"></i> 14 min read
</div>


  </header>
  
  
  <div class="post">
    


<div id="welcome" class="section level2">
<h2>Welcome!</h2>
<p>The practical component of the <strong>Statistics II: Statistical Modeling and Causal Inference</strong> course relies largely in <em>R</em> programming. Today we will center on some of the necessary skills to perform the assignments for the course. Finally, we will dive into some of the substance of the class by exploring the Potential Outcomes Framework.</p>
<p>In this tutorial, you will learn to:</p>
<ul>
<li>identify the some of the basic functionalities of <em>R</em> and <em>RStudio</em></li>
<li>import data sets into your <em>R</em> environment</li>
<li>distinguish the foundations of the Potential Outcomes Framework (POF)</li>
<li>apply <code>dplyr</code> verbs to retrieve estimates</li>
</ul>
</div>
<div id="r-and-rstudio-basics" class="section level2">
<h2>R and RStudio: Basics</h2>
<div id="the-rstudio-layout" class="section level3">
<h3>The RStudio layout</h3>
<p><em>RStudio</em> is an integrated development environment (IDE) for R. Think of <em>RStudio</em> as a front that allows us to interact, compile, and render R code in a more instinctive way. The following image shows what the standard RStudio interface looks like:</p>
<p><img src="https://user-images.githubusercontent.com/54796579/92997228-088e9580-f512-11ea-9dad-556438c91f86.png" width="70%" style="display: block; margin: auto;" /></p>
<ol style="list-style-type: decimal">
<li><p><strong>Console</strong>: The <em>console</em> provides a means to interact directly with <em>R</em>. You can type some code at the <em>console</em> and when you press ENTER, R will run that code. Depending on what you type, you may see some output in the <em>console</em> or if you make a mistake, you may get a warning or an error message.</p></li>
<li><p><strong>Script editor</strong>: You will utilize the <em>script editor</em> to complete your assignments. The <em>script editor</em> will be the space where files will be displayed. For example, once you download and open the bi-weekly assignment .Rmd template, it will appear here. The editor is a where you should place code you care about, since the code from the console cannot be saved into a script.</p></li>
<li><p><strong>Environment</strong>: This area holds the abstractions you have created with your code. If you run <code>myresult &lt;- 5+3+2</code>, the <code>myresult</code> object will appear there.</p></li>
<li><p><strong>Plots and files</strong>: This area will be where graphic output will be generated. Additionally, if you write a question mark before any function, (i.e. <code>?mean</code>) the online documentation will be displayed here.</p></li>
</ol>
<hr />
</div>
<div id="r-packages" class="section level3">
<h3>R Packages</h3>
<p>For the most part, <em>R Packages</em> are collections of code and functions that leverage R programming to expand on the basic functionalities. Last week we met <code>dplyr</code> that aids R programmers in the process of data cleaning and manipulation. There are a plethora of packages in <em>R</em> designed to facilite the completion of tasks. In fact, this tutorial builds on the <code>learnr</code> package that allows us to turn R Markdown documents into interactive tutorials.</p>
<p>Unlike other programming languages, in <em>R</em> you only need to install a package once. The following times you will only need to &quot;require&quot; the package. <strong>As a good practice I recommend running the code to install packages only in your R console, not in the code editor.</strong> You can install a package with the following syntax</p>
<pre class="r"><code>install.packages(&quot;name_of_your_package&quot;) #note that the quotation marks are mandatory at this stage</code></pre>
<p>Once the package has been installed, you just need to &quot;call it&quot; every time you want to use it in a file by running:</p>
<pre class="r"><code>library(&quot;name_of_your_package&quot;) #either of this lines will require the package
library(name_of_your_package) #library understands the code with, or without, quotation marks</code></pre>
<p><strong>It is extremely important that you do not have any lines installing packages for your assignments because the file will fail to knit</strong></p>
<hr />
</div>
<div id="working-directory" class="section level3">
<h3>Working directory</h3>
<p>The <em>working directory</em> is just a file path on your computer that sets the default location of any files you read into R, or save out of R. Normally, when you open <em>RStudio</em> it will have a default directory (a folder in your computer). You can check you directory by running <code>getwd()</code> in your console:</p>
<pre class="r"><code>#this is the default in my case
getwd()
#[1] &quot;/Users/sebastianramirezruiz&quot;</code></pre>
<p><strong>When your RStudio is closed and you open a file from your finder in MacOS or file explorer in Windows, the default working directory will be the folder where the file is hosted</strong></p>
<hr />
</div>
<div id="setting-your-working-directory" class="section level3">
<h3>Setting your working directory</h3>
<p>You can set you directory manually from RStudio: use the menu to change your working directory under Session &gt; Set Working Directory &gt; Choose Directory.</p>
<p><img src="http://www.sthda.com/sthda/RDoc/images/rstudio-change-working-directory.png" width="55%" style="display: block; margin: auto;" /></p>
<p>You can also use the <code>setwd()</code> function:</p>
<pre class="r"><code>setwd(&quot;/path/to/your/directory&quot;) #in macOS
setwd(&quot;c:/path/to/your/directory&quot;) #in windows</code></pre>
<hr />
</div>
<div id="recommended-folder-structure-for-the-class" class="section level3">
<h3>Recommended folder structure for the class</h3>
<p><img src="https://user-images.githubusercontent.com/54796579/92937233-5ee4d100-f44b-11ea-9ee7-cc7209b80562.png" width="100%" style="display: block; margin: auto;" /></p>
<p>We recommend you pay close attention to your folder structure. You can create an independent folder for each assignment. Make the folder your working directory when working on the assignment. This folder will be populated with the template .Rmd and the data for the week. When you knit the file, the <strong>.html</strong> will be created in this folder.</p>
<hr />
</div>
<div id="dealing-with-errors-in-r" class="section level3">
<h3>Dealing with errors in R</h3>
<p>Errors in R occur when code is used in a way that it is not intended. For example when you try to add two character strings, you will get the following error:</p>
<pre class="r"><code>&quot;hello&quot; + &quot;world&quot;
Error in &quot;hello&quot; + &quot;world&quot;: non-numeric argument to binary operator</code></pre>
<p>Normally, when something has gone wrong with your program, <em>R</em> will notify you of an error in the <strong>console</strong>. There are errors that will prevent the code from running, while others will only produce <strong>warning</strong> messages. In the following case, the code will run, but you will notice that the string <strong>&quot;three&quot;</strong> is turned into a NA.</p>
<pre class="r"><code>as.numeric(c(&quot;1&quot;, &quot;2&quot;, &quot;three&quot;))
Warning: NAs introduced by coercion
[1]  1  2 NA</code></pre>
<p>Since we will be utilizing widely used packages and functions in the course of the semester, the errors that you may come across in the process of completing your assignments will be common for other R users. Most errors occur because of typos. A Google search of the error message can take you a long way as well. Most of the times the first entry on <strong>stackoverflow.com</strong> will solve the problem.</p>
<hr />
</div>
</div>
<div id="importing-data" class="section level2">
<h2>Importing data</h2>
<p>Last week we worked with data provided by the <code>palmerpenguins</code> package; however, most practical applications will require you to work with your own data. In fact, for most assignments, you will be given a data set to work with. As we discussed last week, data are messy. You know what else is messy? Data formats. You may be acquainted with a couple of them <em>(.csv, .tsv, .xlsx)</em>.</p>
<p>Fortunately for us, the <code>tidyverse</code> has two packages that make the process of loading data sets from different formats very easy.</p>
<ul>
<li><code>readr</code>: The goal of <code>readr</code> is to provide a fast and friendly way to read rectangular data (like <strong>csv, tsv, rds, and fwf</strong>)</li>
<li><code>haven</code>: The goal of <code>haven</code> is to enable R to read and write various data formats used by other statistical packages (like <strong>dta, sas, and sav</strong>)</li>
</ul>
<p>You can read more about how to load different types of data in the respective documentations of the packages — <a href="https://readr.tidyverse.org/">readr</a> and <a href="https://haven.tidyverse.org/">haven</a></p>
<hr />
<p>For the assignment that went live this week, you will be required to load the <strong>earnings-pof.rds</strong>. You can do that by installing the <code>readr</code> package and utilizing:</p>
<pre class="r"><code>#with readr
your_data_frame &lt;- readr::read_rds(&quot;path_for_the_file&quot;)

#you can alternatively use a base R option
your_data_frame &lt;- base::readRDS(&quot;path_for_the_file&quot;)</code></pre>
<p>When in doubt just Google <strong>&quot;How to load x_format data in R?&quot;</strong> That will do the trick!</p>
<hr />
<div id="the-double-colon-operator" class="section level3">
<h3>The double colon operator ::</h3>
<p>You may have noted in the previous section that the functions were preceded by their package name and two colons, for example: <code>readr::read_rds()</code>. The double colon operator <code>::</code> helps us ensure that we select functions from a particular package. We utilize the operator to explicitly state where the function is coming. This may become even more important when you are doing data analysis as part of a team further in your careers. Though it is likely that this will not be a problem during the course, we can try to employ the following convention <code>package_name::function()</code> to ensure that we will not encounter errors in our knitting process:</p>
<pre class="r"><code>dplyr::select()</code></pre>
<hr />
<p>Let's look at what happens when we load <code>tidyverse</code>.</p>
<pre class="r"><code>library(tidyverse)

#── Attaching packages ──────────────────────────────────────────────────────────────────────────── tidyverse 1.3.0 #──
#✓ ggplot2 3.3.2     ✓ purrr   0.3.4
#✓ tibble  3.0.3     ✓ dplyr   1.0.2
#✓ tidyr   1.1.2     ✓ stringr 1.4.0
#✓ readr   1.3.1     ✓ forcats 0.5.0
#── Conflicts ─────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() #──
#x dplyr::filter() masks stats::filter()
#x dplyr::lag()    masks stats::lag()</code></pre>
<p>You may notice that <em>R</em> points out some conflicts where some functions are being masked. The default in this machine will become the <code>filter()</code> from the <code>dplyr</code> package during this session. If you were to run some code that is based on the <code>filter()</code> from the <code>stats</code> package, your code will probably result in errors.</p>
<hr />
</div>
</div>
<div id="the-potential-outcomes-framework" class="section level2">
<h2>The Potential Outcomes Framework</h2>
<div id="the-pof-in-practice" class="section level3">
<h3>The POF in practice</h3>
<p>Let's revisit the example from the lecture once again. Say we are interested in assessing the premise of Allport's hypothesis about interpersonal contact being conducive to reducing intergroup prejudice. We are studying a set of (<span class="math inline">\(n=8\)</span>) students assigned to a dorm room with a person from their own ethnic group <strong>(contact=0)</strong> and from a different group <strong>(contact=1)</strong>.</p>
<table>
<thead>
<tr class="header">
<th align="center">Student (i)</th>
<th align="center">Prejudice (C=0)</th>
<th align="center">Prejudice (C=1)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">6</td>
<td align="center">5</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">4</td>
<td align="center">2</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">4</td>
<td align="center">4</td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="center">6</td>
<td align="center">7</td>
</tr>
<tr class="odd">
<td align="center">5</td>
<td align="center">3</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">6</td>
<td align="center">2</td>
<td align="center">2</td>
</tr>
<tr class="odd">
<td align="center">7</td>
<td align="center">8</td>
<td align="center">7</td>
</tr>
<tr class="even">
<td align="center">8</td>
<td align="center">4</td>
<td align="center">5</td>
</tr>
</tbody>
</table>
<p><strong>The data are already pre-loaded in the <code>prejudice_df</code> object</strong></p>
</div>
<div id="data-set" class="section level3">
<h3>Data set</h3>
<p>Today we will work with the <code>prejudice_df</code>. The data frame contains the following four variables:</p>
<ul>
<li><code>student_id</code>: numeric student identification</li>
<li><code>prej_0</code>: prejudice level under <span class="math inline">\(Y_{0i}\)</span> (Contact=0)</li>
<li><code>prej_1</code>: prejudice level under <span class="math inline">\(Y_{1i}\)</span> (Contact=1)</li>
<li><code>dorm_type</code>: binary for actual treatment state</li>
</ul>
<pre><code>## # A tibble: 8 x 4
##   student_id prej_0 prej_1 dorm_type
##        &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;
## 1          1      6      5         0
## 2          2      4      2         1
## 3          3      4      4         0
## 4          4      6      7         0
## 5          5      3      1         1
## 6          6      2      2         1
## 7          7      8      7         0
## 8          8      4      5         0</code></pre>
<hr />
</div>
</div>
<div id="treatment-effects" class="section level2">
<h2>Treatment Effects</h2>
<div id="individual-treatment-effect-ite" class="section level3">
<h3>Individual Treatment Effect (ITE)</h3>
<p>We assume from the <em>potential outcomes framework</em> that each subject has a <strong>potential outcome</strong> under both treatment states. Let's take the first student in the list as an example. %&gt;%</p>
<p><img src="https://user-images.githubusercontent.com/54796579/92996733-20641a80-f50e-11ea-8b55-a17da3d8b36f.png" width="65%" style="display: block; margin: auto;" /></p>
<p>The figure illustrates the <strong>potential outcomes</strong> for <em>Student 1</em>. We see that in a reality where <em>Student 1</em> is assigned to in-group dorm <strong>(contact=0)</strong> their levels of prejudice are <em>6</em>. On the contrary, in a reality where <em>Student 1</em> is assigned to co-ethnic dorm <strong>(contact=1)</strong> their levels of prejudice are <em>5</em>.</p>
<p>From this illustration, we can gather the <strong>individual treatment effect (ITE)</strong> for student one. The <strong>ITE</strong> is equal to the values under treatment <em>(contact=1)</em> minus to the values without treatment <em>(contact=0)</em> or <span class="math inline">\(ITE = y_{1i} - y_{0i}\)</span>.</p>
<p><span class="math display">\[ITE = 5 - 6 = -1\]</span></p>
<p>As it was put during the lecture:</p>
<blockquote>
<p>The ITE is a “comparison of two states of the world” (Cunningham, 2021): individuals are exposed to contact, and not exposed to it.</p>
</blockquote>
<p>Evidently, each subject can only be observed in one treatment state at any point in time in real life. This is known as the <strong>fundamental problem</strong> (Holland, 1986) of causal inference. <strong>The Individual Treatment Effect (ITE) in reality is unattainable.</strong> Still, it provides us with a conceptual foundation for causal estimation.</p>
<p><strong>Exercise:</strong> <em>Our data are coming from a world with perfect information. In that sense, we have both potential outcomes <code>prej_0</code> and <code>prej_1</code>. Can you think of a way to calculate the</em> <strong>ITE</strong> <em>for the eight students with one of the <code>dplyr</code> verbs we learned last week?</em></p>
<pre class="r"><code>#you can employ dplyr::mutate() to create the new variable ite
prejudice_df %&gt;% 
  dplyr::mutate(ite = prej_1 - prej_0)</code></pre>
<pre><code>## # A tibble: 8 x 5
##   student_id prej_0 prej_1 dorm_type   ite
##        &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
## 1          1      6      5         0    -1
## 2          2      4      2         1    -2
## 3          3      4      4         0     0
## 4          4      6      7         0     1
## 5          5      3      1         1    -2
## 6          6      2      2         1     0
## 7          7      8      7         0    -1
## 8          8      4      5         0     1</code></pre>
<hr />
</div>
<div id="average-treatment-effect-ate" class="section level3">
<h3>Average Treatment Effect (ATE)</h3>
<p>Normally, we are not interested in the estimates of individual subjects, but rather a population. The <strong>Average Treatment Effect (ATE)</strong> is the difference in the average potential outcomes of the population.</p>
<p><span class="math display">\[ATE = E(Y_{1i}) - E(Y_{0i})\]</span></p>
<p>In other words, the <strong>ATE</strong> is the average <strong>ITE</strong> of all the subjects in the population. As you can see, <strong>the ATE as defined in the formula is also not attainable</strong>. Can you think why?</p>
<p><strong>Exercise:</strong> <em>Since our data are coming from a world with perfect information. Can you think of a way to calculate the</em> <strong>ATE</strong> <em>for the eight students based on what we learned last week?</em></p>
<pre class="r"><code>#we know that the ATE is the averge of every subject&#39;s ITE. Do you remember dplyr::summarize()?
#how can we use the verbs from last week to get the average treatment effect?

prejudice_df %&gt;%
  dplyr::mutate(ite = prej_1 - prej_0) %&gt;%
  dplyr::summarize(mean(ite))</code></pre>
<pre><code>## # A tibble: 1 x 1
##   `mean(ite)`
##         &lt;dbl&gt;
## 1        -0.5</code></pre>
<hr />
</div>
<div id="the-average-treatment-effect-among-the-treated-and-untreated-att-and-atu" class="section level3">
<h3>The Average Treatment Effect Among the Treated and Untreated (ATT) and (ATU)</h3>
<p>The names for these two estimates are very self-explanatory. These two estimates are simply the average treatment effects conditional on the group subjects are assigned to.</p>
<p>The average treatment effect on the treated <strong>ATT</strong> is defined as the difference in the average potential outcomes for those subjects who were treated: <span class="math display">\[ATT = E(Y_{1i}-Y_{0i} | D = 1)\]</span></p>
<p>The average treatment effect on the untreated <strong>ATU</strong> is defined as the difference in the average potential outcomes for those subjects who were not treated: <span class="math display">\[ATU = E(Y_{1i}-Y_{0i} | D = 0)\]</span></p>
<p><strong>Exercise:</strong> <em>Since our data are coming from a world with perfect information. Can you think of a way to calculate the</em> <strong>ATT</strong> <em>and</em> <strong>ATU</strong> <em>for the eight students based on what we learned last week?</em></p>
<pre class="r"><code>#we know that the ATT and ATU are the average of every subject&#39;s ITE grouped by their treatment status. Do you remember how the combination of dplyr::group_by() and dplyr::summarize() worked?
#how can we use the verbs from last week to get the average treatment effect on the treated and untreated?

prejudice_df %&gt;%
  dplyr::mutate(ite = prej_1 - prej_0) %&gt;%
  dplyr::group_by(dorm_type) %&gt;%
  dplyr::summarize(mean(ite))</code></pre>
<pre><code>## # A tibble: 2 x 2
##   dorm_type `mean(ite)`
## *     &lt;dbl&gt;       &lt;dbl&gt;
## 1         0        0   
## 2         1       -1.33</code></pre>
<p><em>What do you think these treatment group differences tell us?</em></p>
<hr />
</div>
<div id="the-näive-average-treatment-effect-nate" class="section level3">
<h3>The Näive Average Treatment Effect (NATE)</h3>
<p>So far, we have worked with perfect information. Still, we know that in reality we can only observe subjects in one treatment state. This is the information we <strong>do</strong> have.</p>
<p><img src="https://user-images.githubusercontent.com/54796579/93014681-527b8800-f5b3-11ea-98f2-200e42f49bd4.png" width="65%" style="display: block; margin: auto;" /></p>
<p>The <strong>Näive Average Treatment Effect (NATE)</strong> is the calculation we can compute based on the observed outcomes.</p>
<p><span class="math display">\[NATE = E(Y_{1i}|D{i}=1) - E(Y_{0i}|D{i}=0)\]</span> *<em>reads in English as: &quot;The expected average outcome under treatment for those treated minus the expected average outcome under control for those not treated&quot;</em></p>
<p><strong>Exercise:</strong> <em>Can you think of a way to calculate the</em> <strong>NATE</strong> <em>for the eight students employing the new <code>observed_prej</code> variable?</em></p>
<pre class="r"><code>#we know that the NATE is the difference in average observed outcomes grouped by their treatment status. Do you remember how the combination of dplyr::group_by() and dplyr::summarize() worked?

prejudice_df %&gt;%
  dplyr::mutate(observed_prej = ifelse(dorm_type == 1, prej_1, prej_0)) %&gt;%
  dplyr::group_by(dorm_type) %&gt;%
  dplyr::summarize(mean(observed_prej))</code></pre>
<pre><code>## # A tibble: 2 x 2
##   dorm_type `mean(observed_prej)`
## *     &lt;dbl&gt;                 &lt;dbl&gt;
## 1         0                  5.6 
## 2         1                  1.67</code></pre>
<hr />
<p><em>Note.</em> The ìfelse() function is a very handy tool to have. It allows us to generate conditional statements. The syntax is the following:</p>
<pre class="r"><code>ifelse(condition_to_meet, what_to_do_if_met, what_to_do_if_not_met)</code></pre>
<p><em>In the case of <code>observed_prej</code>, we ask</em> <strong>R</strong> <em>to create a new variable, where if the subject is in a co-ethnic dorm, we print the prejudice value under treatment. If that condition is not met, we print the prejudice value under control.</em></p>
<hr />
</div>
</div>
<div id="bias" class="section level2">
<h2>Bias</h2>
<div id="bias-1" class="section level3">
<h3>Bias</h3>
<p>During the lecture, we met two sources of bias:</p>
<p><img src="https://user-images.githubusercontent.com/54796579/93015117-13e7cc80-f5b7-11ea-8281-dde25922a883.png" width="65%" style="display: block; margin: auto;" /></p>
<hr />
</div>
<div id="selection-bias" class="section level3">
<h3>Selection bias</h3>
<p>Selection bias is difference in expected outcomes in the absence of treatment for the actual treatment and control group. In other words, these are the underlying differences that individuals in either group start off with.</p>
<hr />
</div>
<div id="heterogeneous-treatment-effect-hte-bias" class="section level3">
<h3>Heterogeneous Treatment Effect (HTE) bias</h3>
<p>Heterogeneous Treatment Effect (HTE) bias is the difference in returns to treatment (the treatment effect) between the treatment and control group, multiplied by the share of the population in control. In other words, this type of bias relates to the dissimilarities stemming for ways in which individuals in either group are affected differently by the treatment.</p>
<p><strong>Exercise:</strong> <em>Since our data are coming from a world with perfect information. Can you think of a way to explore the existence</em> <strong>selection bias</strong> <em>in our data?</em></p>
<pre><code>## # A tibble: 8 x 4
##   student_id prej_0 prej_1 dorm_type
##        &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;
## 1          1      6      5         0
## 2          2      4      2         1
## 3          3      4      4         0
## 4          4      6      7         0
## 5          5      3      1         1
## 6          6      2      2         1
## 7          7      8      7         0
## 8          8      4      5         0</code></pre>
<p><strong>Exercise:</strong> <em>Since our data are coming from a world with perfect information. Can you think of a way to explore the existence</em> <strong>HTE bias</strong> <em>in our data?</em></p>
<pre><code>## # A tibble: 8 x 4
##   student_id prej_0 prej_1 dorm_type
##        &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;
## 1          1      6      5         0
## 2          2      4      2         1
## 3          3      4      4         0
## 4          4      6      7         0
## 5          5      3      1         1
## 6          6      2      2         1
## 7          7      8      7         0
## 8          8      4      5         0</code></pre>
</div>
</div>

  </div>
  

<div class="navigation navigation-single">
    
    
    <a href="/2020-fall-stats2/scripts/lab_3_regression/" class="navigation-next">
      <span class="navigation-tittle">Session 02 - Regression</span>
      <i aria-hidden="true" class="fa fa-chevron-right"></i>
    </a>
    
</div>


  

  
    


</article>


        </div>
        
    

<script defer src="https://use.fontawesome.com/releases/v5.12.1/js/all.js" integrity="sha384-ZbbbT1gw3joYkKRqh0kWyRp32UAvdqkpbLedQJSlnI8iLQcFVxaGyrOgOJiDQTTR" crossorigin="anonymous"></script>


    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
        
    <script type="text/javascript">
        
        hljs.initHighlightingOnLoad();
    </script>
    



    



    </body>
</html>
